<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Store | Official Bigi</title>

  <!-- FONTS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">

  <!-- ICONS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- CSS -->
  <link rel="stylesheet" href="store.css">
</head>

<body>

<!-- HEADER -->
<header class="header">
  <div class="logo">Official Bigi</div>

  <div class="cart-icon" onclick="toggleCart()">
    <i class="fa-solid fa-cart-shopping"></i>
    <span id="cart-count">0</span>
  </div>

  <div class="hamburger" onclick="toggleMenu()">
    <span></span><span></span><span></span>
  </div>

  <nav class="nav" id="nav">
    <a href="index.html">Home</a>
    <a href="music.html">Music</a>
    <a href="videos.html">Videos</a>
    <a href="store.html">Store</a>
    <a href="tour.html">Tour</a>
    <a href="about.html">About</a>
  </nav>
</header>

<!-- CART DRAWER -->
<div class="cart-drawer" id="cart">
  <h3>Your Cart</h3>
  <div id="cart-items"></div>
  <p class="cart-total">Total: KSh <span id="cart-total">0</span></p>
  <button class="checkout-btn" onclick="payWithPaystack()">CHECKOUT</button>
</div>

<!-- STORE -->
<section class="store">
  <h1>MERCH</h1>

  <div class="product-grid">

    <!-- PRODUCT TEMPLATE (x5) -->
    <div class="product-card" data-name="Faith Over Fame – Green">
      <img src="assets/fof-green-shirt.webp" alt="Faith Over Fame Green Shirt">
      <h3>Faith Over Fame – Green</h3>
      <p>KSh 4,500</p>

      <div class="sizes">
        <button>S</button><button>M</button><button>L</button>
        <button>XL</button><button>XXL</button>
      </div>

      <button class="add-btn">ADD TO CART</button>
    </div>

    <div class="product-card" data-name="Faith Over Fame – Black">
      <img src="assets/fof-black-shirt.webp">
      <h3>Faith Over Fame – Black</h3>
      <p>KSh 4,500</p>
      <div class="sizes">
        <button>S</button><button>M</button><button>L</button><button>XL</button><button>XXL</button>
      </div>
      <button class="add-btn">ADD TO CART</button>
    </div>

    <div class="product-card" data-name="Faith Over Fame – Berry">
      <img src="assets/fof-berry-shirt.webp">
      <h3>Faith Over Fame – Berry</h3>
      <p>KSh 4,500</p>
      <div class="sizes">
        <button>S</button><button>M</button><button>L</button><button>XL</button><button>XXL</button>
      </div>
      <button class="add-btn">ADD TO CART</button>
    </div>

    <div class="product-card" data-name="Faith Over Fame – White">
      <img src="assets/fof-white-shirt.webp">
      <h3>Faith Over Fame – White</h3>
      <p>KSh 4,500</p>
      <div class="sizes">
        <button>S</button><button>M</button><button>L</button><button>XL</button><button>XXL</button>
      </div>
      <button class="add-btn">ADD TO CART</button>
    </div>

    <div class="product-card" data-name="Faith Over Fame – Grey">
      <img src="assets/fof-grey-shirt.webp">
      <h3>Faith Over Fame – Grey</h3>
      <p>KSh 4,500</p>
      <div class="sizes">
        <button>S</button><button>M</button><button>L</button><button>XL</button><button>XXL</button>
      </div>
      <button class="add-btn">ADD TO CART</button>
    </div>

  </div>
</section>

<!-- SOCIAL -->
<section class="social-bar">
  <a href="#"><i class="fa-brands fa-apple"></i></a>
  <a href="#"><i class="fa-brands fa-soundcloud"></i></a>
  <a href="#"><i class="fa-brands fa-youtube"></i></a>
  <a href="#"><i class="fa-brands fa-instagram"></i></a>
  <a href="#"><i class="fa-brands fa-x-twitter"></i></a>
  <a href="#"><i class="fa-brands fa-facebook-f"></i></a>
</section>

<!-- FOOTER -->
<footer class="footer">
  <p>© 2025 Official Bigi. All rights reserved.</p>
  <div class="footer-links">
    <a href="privacy.html">Privacy</a>
    <a href="terms.html">Terms</a>
    <a href="cookies.html">Cookies</a>
  </div>
</footer>

<script src="https://js.paystack.co/v1/inline.js"></script>

<script>
let cart = [];
const PAYSTACK_KEY = "pk_live_64c997aee91b22d8db817df8075dd72faa81f2fb";
const PRICE_KES = 4500;

function toggleMenu() {
  document.getElementById("nav").classList.toggle("open");
}

function toggleCart() {
  document.getElementById("cart").classList.toggle("open");
}

document.querySelectorAll('.product-card').forEach(card => {
  let selectedSize = null;

  card.querySelectorAll('.sizes button').forEach(btn => {
    btn.onclick = () => {
      card.querySelectorAll('.sizes button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      selectedSize = btn.textContent;
    };
  });

  card.querySelector('.add-btn').onclick = () => {
    if (!selectedSize) {
      alert('Please select a size first');
      return;
    }

    cart.push({
      name: card.dataset.name,
      size: selectedSize,
      price: PRICE_KES
    });

    updateCart();
  };
});

function updateCart() {
  const items = document.getElementById('cart-items');
  items.innerHTML = '';
  let total = 0;

  cart.forEach(item => {
    total += item.price;
    items.innerHTML += `<p>${item.name} (${item.size}) - KSh ${item.price}</p>`;
  });

  document.getElementById('cart-total').textContent = total;
  document.getElementById('cart-count').textContent = cart.length;
}

function payWithPaystack() {
  if (!cart.length) {
    alert('Your cart is empty');
    return;
  }

  const totalKES = cart.reduce((sum, i) => sum + i.price, 0);

  PaystackPop.setup({
    key: PAYSTACK_KEY,
    email: "customer@officialbigi.com",
    amount: totalKES * 100, // Paystack KES minor units
    currency: "KES",
    metadata: {
      custom_fields: [{
        display_name: "Order",
        variable_name: "items",
        value: cart.map(i => `${i.name} (${i.size})`).join(', ')
      }]
    },
    callback: function(response) {
      alert("Payment successful! Ref: " + response.reference);
      cart = [];
      updateCart();
      toggleCart();
    }
  }).openIframe();
}
</script>

</body>
</html>
